<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Dashboard - Banda transportadora</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
     <link rel="icon" href="img/svg.svg" type="image/x-icon" />
  </head>
  <body class="bg-light">
    <!-- Sidebar -->
    <div class="d-flex">
      <nav class="bg-white shadow-sm p-3 vh-100" style="width: 250px">
        <div class="d-flex align-items-center mb-4">
          <img
            src="img/bambino-contactanos.png"
            alt="Logo"
            width="40"
            class="me-2 rounded-circle"
          />
          <span class="fs-5 fw-bold text-primary">Productos Alimenticios Doria</span>
        </div>

        <!-- <ul class="nav flex-column">
          <li class="nav-item mb-2">
            <a class="nav-link" href="#"
              ><i class="bi bi-speedometer2 me-2"></i>#</a
            >
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link" href="#"
              ><i class="bi bi-bar-chart me-2"></i>#</a
            >
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link" href="#"
              ><i class="bi bi-cart me-2"></i>#</a
            >
          </li>
          <li class="nav-item mb-2">
            <a class="nav-link" href="#"
              ><i class="bi bi-people me-2"></i>#</a
            >
          </li>
        </ul> -->
      </nav>

      <!-- Main -->
      <main class="flex-grow-1 p-4">
        <!-- control de sesión -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <div>
            <h4 class="fw-bold">Bienvenido, <span id="usuario"></span></h4>
            <p class="text-muted">Jefe de turno: <span id="jefe"></span></p>
          </div>
          <div>
            <button
              onclick="cerrarSesion()"
              class="btn btn-outline-danger btn-sm"
            >
              Cerrar sesión
            </button>
          </div>
        </div>

        <!-- Nav Tabs -->
        <ul class="nav nav-tabs mb-4" id="tabDashboard" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="tabMonitor-tab"
              data-bs-toggle="tab"
              data-bs-target="#tabMonitor"
              type="button"
              role="tab"
            >
              Monitor
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="tabEficiencia-tab"
              data-bs-toggle="tab"
              data-bs-target="#tabEficiencia"
              type="button"
              role="tab"
            >
              Eficiencia
            </button>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="tabContent">
          <div
            class="tab-pane fade show active"
            id="tabMonitor"
            role="tabpanel"
          >
            <h5 class="fw-bold mb-3">Monitor de Banda Transportadora</h5>

            <div class="row g-3 mt-2">
              <!-- Vista de cámara -->
              <div class="col-lg-6">
                <div class="card p-3 shadow-sm">
                  <video
                    id="video"
                    autoplay
                    playsinline
                    class="w-100 border rounded"
                  ></video>
                  <canvas id="canvas" class="d-none"></canvas>
                  <div class="mt-2">
                    <span id="estado" class="badge bg-success estado-marcha"
                      >Estado: Marcha</span
                    >
                  </div>
                </div>
              </div>

              <!-- Historial de paradas -->
              <div class="col-lg-6">
                <div class="card p-3 shadow-sm">
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <h6 class="mb-0">Historial de Paradas</h6>
                    <button
                      id="btnExport"
                      class="btn btn-sm btn-outline-primary"
                    >
                      <i class="bi bi-file-earmark-excel"></i> Exportar a Excel
                    </button>
                  </div>

                  <div
                    class="table-responsive"
                    style="max-height: 348px; overflow: auto"
                  >
                    <table
                      class="table table-sm align-middle"
                      id="tablaEventos"
                    >
                      <thead class="table-light sticky-top">
                        <tr>
                          <th>#</th>
                          <th>Inicio Parada</th>
                          <th>Fin Parada</th>
                          <th>Duración</th>
                          <th>Causal</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          

          <div class="tab-pane fade" id="tabEficiencia" role="tabpanel">
             <h5 class="fw-bold mb-3">Grafica de disponibilidad</h5>
            <!-- Tarjeta de la gráfica -->
            <div class="col-lg-6 mx-auto mt-2">
              <div class="card p-2 shadow-sm text-center">
                <h6 class="mb-3 fw-bold">Eficiencia de banda transportadora</h6>
                <canvas
                  id="graficaEficiencia"
                  width="250"
                  height="250"
                ></canvas>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- script para graficas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/dashboard.js"></script>
  </body>
</html>
